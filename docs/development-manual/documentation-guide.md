# Documentation Guide

**Purpose**: Establish the conventions for creating, evolving, and auditing the SomaBrain documentation suite.

**Audience**: Contributors maintaining docs, release managers, and automation engineers.

**Prerequisites**: Familiarity with the repository layout and basic Markdown authoring.

---

## Manual Structure

SomaBrain documentation is organised into four manuals as mandated by the project ADR:

| Manual | Directory | Primary Audience | Notes |
| --- | --- | --- | --- |
| User Manual | `docs/user-manual/` | Product owners & end users | Task-oriented guides (installation, quick start, features, FAQ). |
| Technical Manual | `docs/technical-manual/` | Platform/SRE teams | Architecture, deployment, monitoring, security, runbooks. |
| Development Manual | `docs/development-manual/` | Engineers & contributors | Local setup, coding standards, API reference, testing, documentation guidance. |
| Onboarding Manual | `docs/onboarding-manual/` | New hires & contractors | Context, environment setup, first contribution, collaboration, domain knowledge. |

Each manual contains an `index.md` landing page followed by topical sub-pages. New content **must** be placed under the correct manual; avoid storing Markdown files at the repository root (except `changelog.md`, `glossary.md`, and `style-guide.md`).

---

## File Naming & Layout Rules

1. Use **kebab-case** filenames (`memory-admin.md`, `local-setup.md`).
2. Place related topics in sub-directories (e.g., `docs/technical-manual/runbooks/`, `docs/onboarding-manual/resources/`).
3. Keep directory names singular (`runbooks`, `resources`, `checklists`).
4. Store diagram sources alongside the document using `.puml`, `.drawio`, or `.mermaid` extensions; rendered outputs are generated by CI and must not be committed.
5. Documentation metadata lives in optional YAML front-matter (`title`, `nav_order`, `tags`). When present, ensure keys use snake_case.

---

## Required Page Sections

Every new document must cover the following checkpoints:

| Requirement | Description |
| --- | --- |
| Purpose | State why the document exists within the first paragraph. |
| Audience | Identify who the content is meant for. |
| Prerequisites | List skills, services, or permissions needed before following the guide. |
| Step-by-step instructions | Provide numbered actions with fenced code blocks for commands. |
| Verification | Document how to confirm the procedure succeeded. |
| Common errors | Include a table of symptoms → fixes when applicable. |
| References | Link to related runbooks, APIs, or ADRs at the end. |

When updating an existing page, ensure the checklist still evaluates to ✅. Missing items should be added as part of the same PR.

---

## Change Workflow

1. Create a branch and edit the relevant Markdown files.
2. Run:
   ```bash
   markdownlint-cli2 \"docs/**/*.md\"
   npm run docs:links        # optional link checker
   scripts/render_diagrams.sh  # regenerates PlantUML/Mermaid outputs
   ```
3. Include the `documentation` label on the pull request.
4. Request review from the owning discipline:
   - Platform/SRE for `technical-manual/**`
   - Product/UX for `user-manual/**`
   - Developer Experience for `development-manual/**`
   - Engineering Management for `onboarding-manual/**`
5. CI will run markdown linting, link validation, and the diagram renderer. Merge is blocked until these jobs succeed.

---

## Maintenance Cadence

| Frequency | Action | Owner |
| --- | --- | --- |
| Weekly | Review feedback captured via the site widget; open doc-improvement issues for ratings \< 4/5. | Docs lead |
| Monthly | Spot-check runbooks touched by recent deployments. | Duty SRE |
| Quarterly | Execute `scripts/audit-docs.py` to produce the documentation health report posted to `#somabrain-docs`. | Docs lead |
| Release Cycle | Update `docs/changelog.md`, attach relevant runbooks, and ensure release health runbook reflects current steps. | Release manager |

Archived pages should be moved to `docs/technical-manual/runbooks/archive/` with a deprecation banner at the top.

---

## Automation Hooks

Automation is configured through GitHub Actions:

| Workflow | Trigger | Purpose |
| --- | --- | --- |
| `docs-lint.yml` | Pull requests touching `docs/**` | Runs markdownlint, link checker, and diagram renderer. |
| `audit-docs.yml` | Scheduled (quarterly) | Generates documentation health report using `scripts/audit-docs.py`. |
| `mkdocs-build.yml` | Push to `main` | Rebuilds the published site using MkDocs Material. |

When adding new diagram source files, update `scripts/render_diagrams.sh` so the renderer includes them.

---

## Quick Reference

- **Glossary**: `docs/glossary.md`
- **Style guide**: `docs/style-guide.md`
- **Runbook directory**: `docs/technical-manual/runbooks/`
- **Release artifacts**: `docs/technical-manual/deployment.md` and `release-health-gating.md`
- **Learning loop guidance**: `docs/development-manual/learning-loop.md`

Keep this guide up to date whenever documentation processes change. Treat it as the single source of truth for authoring standards.
