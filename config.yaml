# SomaBrain configuration (copied from config.example.yaml)

# Embeddings
embed_provider: tiny            # tiny|hrr|fde|transformer
embed_dim: 256
embed_dim_target_k: 0          # JL target dim (0 = disabled)
embed_cache_size: 0

# HRR (enable for HRR-first rerank and cleanup)
use_hrr: true
use_hrr_cleanup: false
hrr_dim: 8192
hrr_seed: 42

# Recency damping (seconds -> scorer steps) - ENHANCED: Now managed by adaptive learning system
recall_recency_time_scale: 60.0      # Will be overridden by adaptive system
recall_recency_max_steps: 4096.0    # Will be overridden by adaptive system
wm_recency_time_scale: 60.0         # Will be overridden by adaptive system
wm_recency_max_steps: 4096.0        # Will be overridden by adaptive system

# Predictor
predictor_provider: mahal      # stub|mahal|slow
predictor_timeout_ms: 250
topic_next_event: cog.next_event
topic_config_updates: cog.config.updates
topic_state_updates: cog.state.updates
topic_agent_updates: cog.agent.updates
topic_action_updates: cog.action.updates
topic_global_frame: cog.global.frame

# HRR-first rerank (WM + LTM)
use_hrr_first: true
hrr_rerank_weight: 0.3  # Will be overridden by adaptive system
hrr_rerank_only_low_margin: true
rerank_margin_threshold: 0.05  # Will be overridden by adaptive system

# RAG fusion weights (ENHANCED: Now managed by adaptive learning system)
retriever_weight_vector: 0.35  # Will be overridden by adaptive system
retriever_weight_lexical: 0.55  # Will be overridden by adaptive system
retriever_weight_wm: 0.10      # Will be overridden by adaptive system
retriever_weight_graph: 1.0    # Will be overridden by adaptive system

# Query expansion (bounded) and reranker knobs (off by default)
use_query_expansion: false
query_expansion_variants: 0
reranker_provider: null
reranker_model: null
reranker_top_n: 50
reranker_out_k: 10
reranker_batch: 32

# Diversity rerank (MMR)
use_diversity: true
diversity_method: mmr          # mmr|facility (facility placeholder)
diversity_k: 8
diversity_lambda: 0.5  # Will be overridden by adaptive system

# Adaptive salience - ENHANCED: Now managed by adaptive learning system
use_adaptive_salience: true
salience_target_store_rate: 0.20  # Will be overridden by adaptive system
salience_target_act_rate: 0.10    # Will be overridden by adaptive system
salience_adjust_step: 0.005       # Will be overridden by adaptive system

# Link decay (graph maintenance) - ENHANCED: Now managed by adaptive learning system
link_decay_factor: 0.98  # Will be overridden by adaptive system
link_min_weight: 0.05     # Will be overridden by adaptive system

# Index/Compression (backend hints; local backend may ignore unknown keys)
index_profile: balanced        # low_latency|balanced|high_recall
pq_m: 16
pq_bits: 8
opq_enabled: false
anisotropic_enabled: false
imi_cells: 2048
hnsw_M: 16
hnsw_efc: 100
hnsw_efs: 64

# Rate limits / quotas
# Uncapped limits for local testing (adjust in production)
rate_rps: 100000
rate_burst: 100000
write_daily_limit: 100000000

# Planner (optional)
use_planner: false
plan_max_steps: 5
plan_rel_types: depends_on,causes,part_of,motivates,related

# Microcircuits (optional)
use_microcircuits: false
micro_circuits: 1
micro_vote_temperature: 0.25  # Will be overridden by adaptive system

# Reflection
reflect_similarity_threshold: 0.35  # Will be overridden by adaptive system
reflect_min_cluster_size: 2
reflect_max_summaries: 5

# Graph reasoning defaults (dev)
graph_hops: 2
graph_limit: 20

namespace: somabrain_ns

# Auth (optional)
auth_required: false
api_token: ""

# Demo endpoints (optional; off by default)
# expose_alt_memory_endpoints: false  # /fnom/* and /fractal/*
# expose_brain_demos: false           # /brain/* unified demo endpoints

# Minimal Public API
# When true, only essential endpoints are exposed externally:
#   GET  /health
#   POST /remember
##   POST /recall
#   POST /plan/suggest
#   POST /sleep/run
minimal_public_api: false
