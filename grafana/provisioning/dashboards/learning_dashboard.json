{
  "uid": "learning-core",
  "title": "Learning & Integrator",
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 1,
  "refresh": "30s",
  "panels": [
    {
      "type": "graph",
      "title": "Tau (Exploration Temperature)",
      "datasource": "Prometheus",
      "targets": [{"expr": "somabrain_integrator_tau"}],
      "lines": true,
      "fill": 1,
      "id": 1
    },
    {
      "type": "graph",
      "title": "Next-Event Regret",
      "datasource": "Prometheus",
      "targets": [{"expr": "soma_next_event_regret"}],
      "lines": true,
      "fill": 1,
      "id": 2
    },
    {
      "type": "graph",
      "title": "Integrator Shadow Ratio (Instant)",
      "datasource": "Prometheus",
      "targets": [{"expr": "somabrain_integrator_shadow_ratio"}],
      "lines": true,
      "fill": 1,
      "id": 3
    },
    {
      "type": "graph",
      "title": "OPA Allow vs Deny",
      "datasource": "Prometheus",
      "targets": [
        {"expr": "somabrain_integrator_opa_allow_total"},
        {"expr": "somabrain_integrator_opa_deny_total"}
      ],
      "lines": true,
      "fill": 0,
      "id": 4
    },
    {
      "type": "graph",
      "title": "OPA Decision Latency (p99 approx)",
      "datasource": "Prometheus",
      "targets": [
        {"expr": "histogram_quantile(0.99, sum(rate(somabrain_integrator_opa_latency_seconds_bucket[5m])) by (le))"}
      ],
      "lines": true,
      "id": 5
    },
    {
      "type": "graph",
      "title": "Leader Entropy",
      "datasource": "Prometheus",
      "targets": [{"expr": "sum(rate(somabrain_integrator_leader_entropy_bucket[5m])) by (le, tenant)"}],
      "lines": true,
      "id": 6
    }
  ]
}