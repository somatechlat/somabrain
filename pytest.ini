[pytest]
# Consolidated marker definitions – duplicate sections cause pytest to raise an
# error. All markers are listed under a single ``markers`` key.
markers =
    dev: run tests in dev mode (default)
    strict: run tests with backend enforcement enabled
    full: run tests with full‑stack mode enabled
    integration: mark tests as integration (requires external services like Redis/Kafka/OPA)
    learning: mark tests that validate live adaptation/learning behavior
    unit: fast deterministic tests of pure functions/classes
    contract: schema/invariant tests (Avro, topics, strict‑mode bans)
    performance: timing/resource focused (skipped by default unless -m performance)
    benchmark: heavier exploratory runs (never in CI by default)
    skip_infra: unit tests that should bypass infrastructure readiness checks

# Run only the recall‑related tests (and the direct health check) to avoid
# importing modules that depend on unavailable external services.
# Run only the recall integration test; the direct TestClient health test
# interferes with background tasks in the full app and is not required for the
# recall‑quality objective.
; Removed an overly restrictive -k filter so newly added unit tests are not
; silently deselected. Use -k on the command line to selectively run tests
; when needed (e.g. `pytest -k test_recall`). The pytest_asyncio plugin is
; still enabled by default below.
addopts = -ra -q -p pytest_asyncio
testpaths = tests
filterwarnings =
    ignore::DeprecationWarning
