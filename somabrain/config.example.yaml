# SomaBrain example configuration (Balanced profile)
# Copy to config.yaml to enable.

# Embeddings
embed_provider: tiny            # tiny|hrr|fde|transformer
embed_dim: 256
embed_dim_target_k: 0          # JL target dim (0 = disabled)
embed_cache_size: 0

# HRR (enable for HRR-first rerank and cleanup)
use_hrr: true
use_hrr_cleanup: false
hrr_dim: 8192
hrr_seed: 42

# Predictor
predictor_provider: mahal      # stub|mahal|slow
predictor_timeout_ms: 250

# HRR-first rerank (WM + LTM)
use_hrr_first: true
hrr_rerank_weight: 0.3
hrr_rerank_only_low_margin: true
rerank_margin_threshold: 0.05

# Diversity rerank (MMR)
use_diversity: true
diversity_method: mmr          # mmr|facility (facility placeholder)
diversity_k: 8
diversity_lambda: 0.5

# Adaptive salience
use_adaptive_salience: true
salience_target_store_rate: 0.20
salience_target_act_rate: 0.10
salience_adjust_step: 0.005

# Link decay (graph maintenance)
link_decay_factor: 0.98
link_min_weight: 0.05

# Index/Compression (backend hints; local backend may ignore unknown keys)
index_profile: balanced        # low_latency|balanced|high_recall
pq_m: 16
pq_bits: 8
opq_enabled: false
anisotropic_enabled: false
imi_cells: 2048
hnsw_M: 16
hnsw_efc: 100
hnsw_efs: 64

# Rate limits / quotas
rate_rps: 50
rate_burst: 100
write_daily_limit: 10000

# Planner (optional)
use_planner: false
plan_max_steps: 5
plan_rel_types: depends_on,causes,part_of,motivates,related

# Microcircuits (optional)
use_microcircuits: false
micro_circuits: 1
micro_vote_temperature: 0.25

# Reflection
reflect_similarity_threshold: 0.35
reflect_min_cluster_size: 2
reflect_max_summaries: 5

# Memory backend
memory_mode: local             # local|http|stub
namespace: somabrain_ns

# Auth (optional)
auth_required: false
api_token: ""

# -----
# Alternative presets (uncomment and override above if desired)

# Low-latency (phone/edge)
# use_hrr: false
# use_hrr_first: false
# use_diversity: false
# predictor_provider: stub
# use_adaptive_salience: false
# index_profile: low_latency

# High-recall (server)
# use_hrr: true
# use_hrr_first: true
# hrr_rerank_only_low_margin: false
# use_diversity: true
# diversity_k: 12
# predictor_provider: mahal
# use_adaptive_salience: true
# index_profile: high_recall
